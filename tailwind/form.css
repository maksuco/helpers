@layer base {

	.label {
		@apply flex items-center text-xs text-label md:max-w-sm uppercase font-semibold tracking-wider mb-1.5 leading-none;

		&.required::after {
			content: "*";
			@apply text-red-500 ml-1.5;
			margin-top: -0.3em;
			font-size: 1.3em;
		}
	}

	.form-basic,
	.form-muted {
		@apply w-full md:max-w-sm px-3 py-2 text-[0.9375rem] border focus:outline-none focus:ring-1 focus:ring-blue-500/50 focus:border-blue-500 transition-all;
		border-radius: var(--btn-radius);
	}

	.form-basic {
		@apply bg-white dark:bg-default-900 border-default-400 dark:border-default-600 text-default-900 dark:text-white placeholder-default-400 dark:placeholder-default-600;
	}

	.form-muted {
		@apply bg-light border-default-200 dark:border-default-700 text-default-950 dark:text-white placeholder-default-400 dark:placeholder-default-500;
	}

	:is(.form-basic, .form-muted)::-webkit-datetime-edit-ampm-field:focus,
	:is(.form-basic, .form-muted)::-webkit-datetime-edit-meridiem-field:focus,
	:is(.form-basic, .form-muted)::-webkit-datetime-edit-day-field:focus,
	:is(.form-basic, .form-muted)::-webkit-datetime-edit-hour-field:focus,
	:is(.form-basic, .form-muted)::-webkit-datetime-edit-minute-field:focus,
	:is(.form-basic, .form-muted)::-webkit-datetime-edit-month-field:focus,
	:is(.form-basic, .form-muted)::-webkit-datetime-edit-second-field:focus,
	:is(.form-basic, .form-muted)::-webkit-datetime-edit-year-field:focus {
		color: white !important;
		-webkit-text-fill-color: white !important;
	}

	/* Safari selection */
	:is(.form-basic, .form-muted)::selection,
	:is(.form-basic, .form-muted)::-webkit-datetime-edit-ampm-field::selection,
	:is(.form-basic, .form-muted)::-webkit-datetime-edit-meridiem-field::selection,
	:is(.form-basic, .form-muted)::-webkit-datetime-edit-hour-field::selection,
	:is(.form-basic, .form-muted)::-webkit-datetime-edit-minute-field::selection {
		color: white;
		-webkit-text-fill-color: white;
	}

	.form-sm {
		@apply px-3 py-[5px] text-[13.5px];
		border-radius: calc(var(--btn-radius) - 1px);
		background-size: 1.25em 1.25em;
	}

	.form-lg {
		@apply px-5 py-[10px] text-base;
		border-radius: calc(var(--btn-radius) + 1px);
		background-size: 1.75em 1.75em;
	}

	.form-xl {
		@apply px-5.5 py-[13px] text-lg font-semibold;
		border-radius: calc(var(--btn-radius) + 2px);
		background-size: 2em 2em;
	}

	/* Number Input Arrows */
	:is(.form-basic, .form-muted)[type="number"]::-webkit-inner-spin-button,
	:is(.form-basic, .form-muted)[type="number"]::-webkit-outer-spin-button {
		-webkit-appearance: none;
		/* Hide standard */
		margin: 0;
	}

	/* Attempt to style spin buttons only if not hidden by reset */
	:is(.form-basic, .form-muted)[type="number"],
	:is(.form-basic, .form-muted)[type="date"],
	:is(.form-basic, .form-muted)[type="time"] {
		@apply text-default-900 dark:text-white;
		-moz-appearance: textfield;
	}

	.input-number-slate::-webkit-inner-spin-button {
		opacity: 1;
		filter: invert(0.5) sepia(1) saturate(0) hue-rotate(0deg) brightness(0.6);
		/* Rough approximation of slate */
		cursor: pointer;
		display: block;
		height: 100%;
	}

	textarea {
		@apply min-h-[1.5rem] resize-y;
	}


	select {
		@apply cursor-pointer appearance-none;
		background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
		background-position: right 0.5rem center;
		background-repeat: no-repeat;
		background-size: 1.5em 1.5em;
		@apply pr-10;
	}

	.range {
		--height: 0.7rem;
		@apply w-full min-h-2 bg-light appearance-none cursor-pointer accent-brand-600;
		height: var(--height);
		border-radius: calc(var(--btn-radius) + 2px);

		/* Thumb Styles */
		&::-webkit-slider-thumb {
			@apply appearance-none w-6 bg-brand rounded-full border border-white/30 transition-transform hover:scale-110 shadow-lg;
			width: calc(var(--height) * 1.9);
			height: calc(var(--height) * 1.4);
		}

		&::-moz-range-thumb {
			@apply size-4 bg-brand rounded-full border border-white/30 transition-transform hover:scale-110 shadow-lg;
		}
	}


	.form-range {
		--height: 1rem;
		height: var(--height, 1rem);
		width: 100%;
		@apply appearance-none cursor-pointer overflow-hidden rounded-full bg-transparent;

		&:focus {
			outline: none;
		}

		&:focus-visible::-webkit-slider-thumb {
			--focus-shadow: 0 0 0 6px var(--fallback-b1, oklch(var(--b1)/1)) inset, 0 0 0 2rem var(--color-brand) inset;
		}

		/*LINE*/
		&::-webkit-slider-runnable-track {
			@apply rounded-full w-full bg-light;
			height: 80%;
		}

		&::-webkit-slider-thumb {
			@apply relative appearance-none aspect-square rounded-full bg-white text-brand;
			height: calc(var(--height) * 1.2);
			border-style: none;
			top: 50%;
			transform: translateY(-50%);
			box-shadow:
				0 0 0 calc(var(--height) * 0.2) var(--color-brand) inset,
				calc(100rem * -1 - calc(var(--height) * 0.6)) 0 0 100rem var(--color-brand);
		}
	}

	.checkbox {
		@apply appearance-none border-default-300 dark:border-default-700 bg-default-100 dark:bg-default-900 text-blue-600 focus:ring-blue-500 focus:ring-offset-default-900 border checked:bg-brand dark:checked:bg-brand-600 checked:border-transparent transition duration-200 align-top bg-no-repeat bg-center;
		width: 1.1em;
		height: 1.1em;
		border-radius: calc(var(--btn-radius) - 0.1em);
	}

	.checkbox:checked {
		background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e");
	}

	.radio {
		@apply appearance-none rounded-full border-default-300 dark:border-default-700 bg-default-100 dark:bg-default-900 text-blue-600 focus:ring-blue-500 focus:ring-offset-default-900 border checked:bg-brand dark:checked:bg-brand checked:border-transparent transition duration-200 align-top;
		width: 1.15em;
		height: 1.15em;
	}

	.radio:checked {
		background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3ccircle cx='8' cy='8' r='3'/%3e%3c/svg%3e");
		background-repeat: no-repeat;
		background-position: center;
	}


	.form-navbar {
		@apply w-auto flex relative isolate scroll-x;
		@apply before:bg-white/80 dark:before:bg-white/10 before:z-0;
		@apply after:bg-brand/90 after:z-1;

		&::before,
		&::after {
			content: "";
			@apply absolute pointer-events-none;
			inset: 0;
			top: anchor(top);
			bottom: anchor(bottom);
			left: anchor(left);
			right: anchor(right);
			border-radius: var(--btn-radius);
		}

		/* Hover pill (unchanged) */
		&:before {
			position-anchor: --btn-hover;
			transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
		}

		/* Active pill */
		&:after {
			position-anchor: --btn-active;
			transition: all 0.65s cubic-bezier(0.23, 1, 0.32, 1);
		}

		/* Hover anchor (unchanged) */
		& button:hover {
			anchor-name: --btn-hover;
		}

		& button {
			@apply z-10;
		}

		&:has(.btn-xs) {
			border-radius: calc(var(--btn-radius) - 2px);
		}

		&:has(.btn-sm) {
			border-radius: calc(var(--btn-radius) - 1px);
		}

		&:has(.btn-lg) {
			border-radius: calc(var(--btn-radius) + 1px);
		}

		/* ----- ACTIVE ANCHOR ROUTING (NO data-*) ----- */

		&:has(button.active:nth-child(1)) button:nth-child(1) {
			anchor-name: --btn-active;
		}

		&:has(button.active:nth-child(2)) button:nth-child(2) {
			anchor-name: --btn-active;
		}

		&:has(button.active:nth-child(3)) button:nth-child(3) {
			anchor-name: --btn-active;
		}

		&:has(button.active:nth-child(4)) button:nth-child(4) {
			anchor-name: --btn-active;
		}

		&:has(button.active:nth-child(5)) button:nth-child(5) {
			anchor-name: --btn-active;
		}

		&:has(button.active:nth-child(6)) button:nth-child(6) {
			anchor-name: --btn-active;
		}

		&:has(button.active:nth-child(7)) button:nth-child(7) {
			anchor-name: --btn-active;
		}

		&:has(button.active:nth-child(8)) button:nth-child(8) {
			anchor-name: --btn-active;
		}

		&:has(button.active:nth-child(9)) button:nth-child(9) {
			anchor-name: --btn-active;
		}

		&:has(button.active:nth-child(10)) button:nth-child(10) {
			anchor-name: --btn-active;
		}

		/* Active visual state */
		& button.active {
			@apply text-white transition-all duration-500 delay-80;
		}
	}

	.form-switch {
		@apply appearance-none disabled:opacity-50 disabled:pointer-events-none;
		@apply bg-light relative w-[2.8rem] p-px border-transparent rounded-full cursor-pointer transition;
		@apply checked:bg-none border-white/20;
		@apply before:inline-block before:w-6 before:h-6 before:bg-white before:translate-x-0 before:shadow-sm checked:before:translate-x-3/4 before:rounded-full before:transform before:transition dark:before:bg-white;
		line-height: .81;
		height: calc(theme('spacing.6') + 2px);

		&:checked {
			@apply bg-brand dark:bg-brand-600;
		}

		&:checked::before {
			@apply bg-white;
		}
	}

	.form-switch-sm {
		@apply before:w-4 before:h-4;
		height: calc(theme('spacing.4') + 2px);
		width: 2rem;
		line-height: .75;
	}

	.form-switch-lg {
		@apply w-[3.7rem] p-0.5;
		@apply before:w-8 before:h-8;
		height: calc(theme('spacing.8') + 4px);
		line-height: .8;
	}


	/* BUTTON STYLE INPUTS */
	.btn-check:checked+.btn {
		@apply !btn-brand;
	}

	/* CHECKED INDICATOR CLASS */
	.has-checked-indicator {
		@apply relative;
	}

	.form-checkmark {
		--check-color: var(--color-green-500);
		@apply relative border rounded-md transition-colors;

		/* Hide input but keep it accessible */
		&>input {
			@apply sr-only;
		}

		/* Checked state â†’ apply styles to the element itself */
		&:has(input:checked) {
			@apply border-[var(--check-color)] ring-1 ring-[var(--check-color)] shadow-[var(--check-color)];
		}

		/* Prevent hover override when checked */
		&:has(input:checked):hover {
			@apply border-[var(--check-color)];
		}

		/* Checkmark */
		&:has(input:checked)::after {
			@apply checkmark_default border-2 border-bg;
		}
	}

	.checkmark {
		@apply relative;

		&::after {
			@apply checkmark_default;
		}
	}

	/* Slate Number Arrows - Helper Class */
	.input-number-arrows::-webkit-inner-spin-button,
	.input-number-arrows::-webkit-outer-spin-button {
		-webkit-appearance: none;
		background-image: url("data:image/svg+xml,%3csvg width='10' height='20' viewBox='0 0 10 20' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M1 8L5 4L9 8' stroke='%2364748b' stroke-width='2' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3e%3cpath d='M1 12L5 16L9 12' stroke='%2364748b' stroke-width='2' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3e%3c/svg%3e");
		background-repeat: no-repeat;
		background-position: center;
		width: 20px;
		height: 100%;
		opacity: 1;
		display: block;
		cursor: pointer;
		position: absolute;
		right: 2px;
		height: 100%;
	}

	.input-number-arrows {
		position: relative;
	}

	.form-combo {
		@apply w-auto md:max-w-sm inline-flex items-stretch overflow-hidden;
		@apply border border-default-300 dark:border-default-600;
		border-radius: var(--btn-radius);

		/* Reset border-radius on all direct children */
		>* {
			border-radius: 0 !important;
			@apply border-0 ring-0;
		}

		/* First child gets left border-radius */
		>*:first-child {
			border-top-left-radius: var(--btn-radius) !important;
			border-bottom-left-radius: var(--btn-radius) !important;
		}

		/* Last child gets right border-radius */
		>*:last-child {
			border-top-right-radius: var(--btn-radius) !important;
			border-bottom-right-radius: var(--btn-radius) !important;
		}

		/* Divider borders between children */
		>*+* {
			@apply border-l border-default-300 dark:border-default-600;
		}

		/* Reset input focus styles within combo */
		input,
		select {
			@apply focus:outline-none focus:ring-0;
		}

		/* Hide select arrows inside combo */
		select {
			background-image: none;
			padding-right: 0.75rem;
		}

		/* Number input - hide spinners */
		input[type="number"] {
			-moz-appearance: textfield;

			&::-webkit-inner-spin-button,
			&::-webkit-outer-spin-button {
				-webkit-appearance: none;
				margin: 0;
			}
		}

		/* Static text addon (currency symbols, units, etc) */
		.combo-text {
			@apply flex items-center px-2 border-0;
			@apply font-medium text-default-500 dark:text-default-400;
			@apply bg-default-100/90 dark:bg-default-800/80;
		}
	}

	.form-success,
	.form-error {
		background-repeat: no-repeat;
		background-position: right 3.8px top 3.2px;
		background-size: 1em 1em;

		@media (width >=48rem) {
			background-position: right 5px top 5px;
		}
	}

	.form-success {
		background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3E%3Ccircle cx='10' cy='10' r='10' fill='%2322c55e'/%3E%3Cpath d='M5.5 10.5l3 3 6-6' stroke='white' stroke-width='2' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
	}

	.form-error {
		background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3E%3Ccircle cx='10' cy='10' r='10' fill='%23ef4444'/%3E%3Cpath d='M7 7l6 6m0-6l-6 6' stroke='white' stroke-width='2' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
	}
}

@utility checkmark_default {
	--check-color: var(--color-green-600);
	content: '';
	background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3e%3cpath d='M20 6L9 17l-5-5'/%3e%3c/svg%3e");
	background-size: 66%;
	background-position: center;
	background-repeat: no-repeat;
	@apply absolute -top-1.5 -right-1.5 bg-[var(--check-color)] rounded-full shadow-sm z-10;
	width: var(--check-size, calc(var(--spacing) * 5));
	height: var(--check-size, calc(var(--spacing) * 5));
	animation: ping 0.3s ease-out reverse;
}

@utility btn-input {
	--btn-color: var(--color-default-500);
	@apply bg-white dark:bg-default-900 border border-default-400 dark:border-default-700 px-3 py-2 text-default-900 dark:text-white focus:outline-none focus:ring-1 focus:ring-blue-500/50 focus:border-blue-500;

	.label {
		@apply mb-0;
	}
}